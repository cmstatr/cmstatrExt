<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="cmstatrExt">
<title>p-Values for Equivalency • cmstatrExt</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="p-Values for Equivalency">
<meta property="og:description" content="cmstatrExt">
<meta property="og:image" content="https://cmstatrExt.cmstatr.net/reference/figures/logo-240x278.png">
<meta property="og:image:alt" content="More statistical methods for composite material data: cmstatrExt">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">cmstatrExt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/stress-strain.html">Stress-Strain Curves</a>
    <a class="dropdown-item" href="../articles/equivalency-p-values.html">p-Values for Equivalency</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Calculators</h6>
    <a class="dropdown-item" href="../articles/compute-equiv-factors.html">Equivalency Factor Calculator</a>
    <a class="dropdown-item" href="../articles/compute-p-value-equiv.html">Equivalency p-Value Calculator</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cmstatr/cmstatrExt/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>p-Values for Equivalency</h1>
                        <h4 data-toc-skip class="author">Stefan
Kloppenborg</h4>
            
            <h4 data-toc-skip class="date">2024-05-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cmstatr/cmstatrExt/blob/HEAD/vignettes/equivalency-p-values.Rmd" class="external-link"><code>vignettes/equivalency-p-values.Rmd</code></a></small>
      <div class="d-none name"><code>equivalency-p-values.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The dual acceptance criteria used for composite materials accept or
reject a new lot of material (or a process change) based on the sample
minimum and sample mean from the new lot of material. Acceptance limits
are normally set such that under the null hypothesis, there is an equal
probability of rejecting the lot due to the minimum and rejecting the
lot due to the mean. These acceptance limits are set so that the
probability of rejecting the lot (due to <em>either</em> the minimum or
mean) under the null hypothesis is <span class="math inline">\(\alpha\)</span>. If we eliminate the constraint
that there is an equal probability of rejecting a lot due to the minimum
or the mean, there is not longer unique values for the acceptance
limits: instead, we can calculate a p-value from the sample minimum and
the sample mean and compare this p-value with the selected value of
<span class="math inline">\(\alpha\)</span>.</p>
<p>The <code>cmstatrExt</code> package provides functions for computing
acceptance limits, p-values and curves indicating all values of the
minimum and mean that result in the same p-value. This vignette
demonstrates this functionality. The “two-sample” method in which only
the sample statistics for the qualification data are known.</p>
<p><strong>Caution:</strong> If the true mean of the population from
which the acceptance sample is drawn is higher than the population mean
for the qualification distribution, then using the p-value method here
may declare an acceptance sample as equivalent even if the standard
deviation is larger. This is due to the fact that this statistical test
is a one-sided test. Similarly, if the acceptance population has a much
lower standard deviation than the qualification population, this test
may allow for an undesirable decrease in mean. As such, considerable
judgement is required when using this method.</p>
<p>In this vignette, we’ll use the <code>cmstatrExt</code> package.
We’ll also use the <code>tidyverse</code> package for data manipulation
and graphing. Finally, we’ll use one of the example data sets from the
<code>cmstatr</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cmstatr/cmstatrExt" class="external-link">cmstatrExt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.cmstatr.net/" class="external-link">cmstatr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-data">Example Data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h2>
<p>As an example, we’ll use the RTD warp tension strength from the
<code>carbon.fabric.2</code> example data set from the
<code>cmstatr</code> package. This data is as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">carbon.fabric.2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"RTD"</span> <span class="op">&amp;</span> <span class="va">test</span> <span class="op">==</span> <span class="st">"WT"</span><span class="op">)</span></span>
<span><span class="va">dat</span></span>
<span><span class="co">#&gt;    test condition batch panel thickness nplies strength modulus failure_mode</span></span>
<span><span class="co">#&gt; 1    WT       RTD     A     1     0.113     14  129.224   8.733          LAB</span></span>
<span><span class="co">#&gt; 2    WT       RTD     A     1     0.112     14  144.702   8.934      LAT,LWB</span></span>
<span><span class="co">#&gt; 3    WT       RTD     A     1     0.113     14  137.194   8.896          LAB</span></span>
<span><span class="co">#&gt; 4    WT       RTD     A     1     0.113     14  139.728   8.835      LAT,LWB</span></span>
<span><span class="co">#&gt; 5    WT       RTD     A     2     0.113     14  127.286   9.220          LAB</span></span>
<span><span class="co">#&gt; 6    WT       RTD     A     2     0.111     14  129.261   9.463          LAT</span></span>
<span><span class="co">#&gt; 7    WT       RTD     A     2     0.112     14  130.031   9.348          LAB</span></span>
<span><span class="co">#&gt; 8    WT       RTD     B     1     0.111     14  140.038   9.244      LAT,LGM</span></span>
<span><span class="co">#&gt; 9    WT       RTD     B     1     0.111     14  132.880   9.267          LWT</span></span>
<span><span class="co">#&gt; 10   WT       RTD     B     1     0.113     14  132.104   9.198          LAT</span></span>
<span><span class="co">#&gt; 11   WT       RTD     B     2     0.114     14  137.618   9.179      LAT,LAB</span></span>
<span><span class="co">#&gt; 12   WT       RTD     B     2     0.113     14  139.217   9.123          LAB</span></span>
<span><span class="co">#&gt; 13   WT       RTD     B     2     0.113     14  134.912   9.116          LAT</span></span>
<span><span class="co">#&gt; 14   WT       RTD     B     2     0.111     14  141.558   9.434    LAB / LAT</span></span>
<span><span class="co">#&gt; 15   WT       RTD     C     1     0.108     14  150.242   9.451          LAB</span></span>
<span><span class="co">#&gt; 16   WT       RTD     C     1     0.109     14  147.053   9.391          LGM</span></span>
<span><span class="co">#&gt; 17   WT       RTD     C     1     0.111     14  145.001   9.318      LAT,LWB</span></span>
<span><span class="co">#&gt; 18   WT       RTD     C     1     0.113     14  135.686   8.991    LAT / LAB</span></span>
<span><span class="co">#&gt; 19   WT       RTD     C     1     0.112     14  136.075   9.221          LAB</span></span>
<span><span class="co">#&gt; 20   WT       RTD     C     2     0.114     14  143.738   8.803      LAT,LGM</span></span>
<span><span class="co">#&gt; 21   WT       RTD     C     2     0.113     14  143.715   8.893      LAT,LAB</span></span>
<span><span class="co">#&gt; 22   WT       RTD     C     2     0.113     14  147.981   8.974      LGM,LWB</span></span>
<span><span class="co">#&gt; 23   WT       RTD     C     2     0.112     14  148.418   9.118      LAT,LWB</span></span>
<span><span class="co">#&gt; 24   WT       RTD     C     2     0.113     14  135.435   9.217      LAT/LAB</span></span>
<span><span class="co">#&gt; 25   WT       RTD     C     2     0.113     14  146.285   8.920      LWT/LWB</span></span>
<span><span class="co">#&gt; 26   WT       RTD     C     2     0.111     14  139.078   9.015          LAT</span></span>
<span><span class="co">#&gt; 27   WT       RTD     C     2     0.112     14  146.825   9.036      LAT/LWT</span></span>
<span><span class="co">#&gt; 28   WT       RTD     C     2     0.110     14  148.235   9.336      LWB/LAB</span></span></code></pre></div>
<p>From this sample, we can calculate the following summary statistics
for the strength:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qual</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">strength</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">strength</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">qual</span></span>
<span><span class="co">#&gt;    n     mean       sd</span></span>
<span><span class="co">#&gt; 1 28 139.6257 6.716047</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="acceptance-limits">Acceptance Limits<a class="anchor" aria-label="anchor" href="#acceptance-limits"></a>
</h2>
<p>We can calculate the acceptance factors acceptance sample size of 8
and <span class="math inline">\(alpha=0.05\)</span> using the
<code>cmstatrExt</code> package as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/k_equiv_two_sample.html">k_equiv_two_sample</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="va">qual</span><span class="op">$</span><span class="va">n</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">k</span></span>
<span><span class="co">#&gt; [1] 2.9462891 0.7972005</span></span></code></pre></div>
<p>These factors can be transformed into limits using the following
equations:</p>
<p><span class="math display">\[
W_{indiv} = \bar{x}_{qual} - k_1 s_{qual} \\
W_{mean} = \bar{x}_{qual} - k_2 s_{qual}
\]</span></p>
<p>Implementing this in R:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">acceptance_limits</span> <span class="op">&lt;-</span> <span class="va">qual</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="va">k</span> <span class="op">*</span> <span class="va">qual</span><span class="op">$</span><span class="va">sd</span></span>
<span><span class="va">acceptance_limits</span></span>
<span><span class="co">#&gt; [1] 119.8383 134.2717</span></span></code></pre></div>
<p>So, if an acceptance sample has a minimum individual less than 119.8
or a mean less than 134.3, we would reject it.</p>
</div>
<div class="section level2">
<h2 id="p-value">p-Value<a class="anchor" aria-label="anchor" href="#p-value"></a>
</h2>
<p>You might ask what happens if there’s one low value in the acceptance
sample that’s below the acceptance limit for minimum individual, but the
mean is well above the limit. The naive response would be to reject the
sample. But, the acceptance limits that we just calculated are based on
setting an equal probability of rejecting a sample based on the minimum
and the mean under the null hypothesis — there are other pairs of
minimum and mean values that have the same p-value as the acceptance
limits that we calculated.</p>
<p>In order to use the p-value function from the <code>cmstatrExt</code>
package, we need to apply the following transformation:</p>
<p><span class="math display">\[
t_1 = \frac{\bar{x}_{qual} - x_{acceptance\,(1)}}{s_{qual}} \\
t_2 = \frac{\bar{x}_{qual} - \bar{x}_{acceptance}}{s_{qual}}
\]</span></p>
<p>As a demonstration, let’s first calculate the p-value of the
acceptance limits. We should get <span class="math inline">\(p=\alpha\)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/p_equiv_two_sample.html">p_equiv_two_sample</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="va">qual</span><span class="op">$</span><span class="va">n</span>,</span>
<span>  m <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  t1 <span class="op">=</span> <span class="op">(</span><span class="va">qual</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="va">acceptance_limits</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="va">qual</span><span class="op">$</span><span class="va">sd</span>,</span>
<span>  t2 <span class="op">=</span> <span class="op">(</span><span class="va">qual</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="va">acceptance_limits</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="va">qual</span><span class="op">$</span><span class="va">sd</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.05003139</span></span></code></pre></div>
<p>This value is very close to <span class="math inline">\(\alpha=0.05\)</span> — within expected numeric
precision.</p>
<p>Now, let’s consider the case where the sample minimum is 116 and the
mean is 138. The sample minimum is below the acceptance limit (116 &lt;
120), but the sample mean is well above the acceptance limit (138 &gt;
134). Let’s calculate the p-value for this case:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/p_equiv_two_sample.html">p_equiv_two_sample</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="va">qual</span><span class="op">$</span><span class="va">n</span>,</span>
<span>  m <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  t1 <span class="op">=</span> <span class="op">(</span><span class="va">qual</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="fl">116</span><span class="op">)</span> <span class="op">/</span> <span class="va">qual</span><span class="op">$</span><span class="va">sd</span>,</span>
<span>  t2 <span class="op">=</span> <span class="op">(</span><span class="va">qual</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="fl">138</span><span class="op">)</span> <span class="op">/</span> <span class="va">qual</span><span class="op">$</span><span class="va">sd</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.2771053</span></span></code></pre></div>
<p>Since this value is well above the selected value of <span class="math inline">\(\alpha=0.05\)</span>, we would accept this sample.
This sort of analysis can be useful during site- or process-equivalency
programs, or for MRB activities.</p>
</div>
<div class="section level2">
<h2 id="curves-of-constant-p-values">Curves of Constant p-Values<a class="anchor" aria-label="anchor" href="#curves-of-constant-p-values"></a>
</h2>
<p>The <code>cmstatrExt</code> package provides a function that produces
a <code>data.frame</code> containing values of <span class="math inline">\(t_1\)</span> and <span class="math inline">\(t_2\)</span> that result in the same p-value. We
can create such a <code>data.frame</code> for p-values of 0.05 as
follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">curve</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/iso_equiv_two_sample.html">iso_equiv_two_sample</a></span><span class="op">(</span><span class="va">qual</span><span class="op">$</span><span class="va">n</span>, <span class="fl">8</span>, <span class="fl">0.05</span>, <span class="fl">4</span>, <span class="fl">1.5</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">curve</span></span>
<span><span class="co">#&gt;          t1        t2</span></span>
<span><span class="co">#&gt; 1  4.000000 0.6876226</span></span>
<span><span class="co">#&gt; 2  3.870890 0.6892186</span></span>
<span><span class="co">#&gt; 3  3.742796 0.6924106</span></span>
<span><span class="co">#&gt; 4  3.616481 0.6971987</span></span>
<span><span class="co">#&gt; 5  3.492200 0.7027848</span></span>
<span><span class="co">#&gt; 6  3.372239 0.7115630</span></span>
<span><span class="co">#&gt; 7  3.258124 0.7235332</span></span>
<span><span class="co">#&gt; 8  3.152269 0.7394934</span></span>
<span><span class="co">#&gt; 9  3.056580 0.7594437</span></span>
<span><span class="co">#&gt; 10 2.975250 0.7849802</span></span>
<span><span class="co">#&gt; 11 2.880451 0.8321028</span></span>
<span><span class="co">#&gt; 12 2.825808 0.8732404</span></span>
<span><span class="co">#&gt; 13 2.782601 0.9266275</span></span>
<span><span class="co">#&gt; 14 2.749561 0.9895908</span></span>
<span><span class="co">#&gt; 15 2.726687 1.0602149</span></span>
<span><span class="co">#&gt; 16 2.713980 1.1365848</span></span>
<span><span class="co">#&gt; 17 2.706355 1.2156679</span></span>
<span><span class="co">#&gt; 18 2.701272 1.2961076</span></span>
<span><span class="co">#&gt; 19 2.701272 1.3776646</span></span>
<span><span class="co">#&gt; 20 2.698730 1.4591417</span></span></code></pre></div>
<p>We can plot this curve using <code>ggplot2</code>, which is part of
the <code>tidyverse</code> package:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">curve</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">t1</span>, y <span class="op">=</span> <span class="va">t2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Acceptance criteria for alpha=0.05"</span><span class="op">)</span></span></code></pre></div>
<p><img src="equivalency-p-values_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>When you plot this, make sure to use <code>geom_path</code> and not
<code>geom_line</code>. The former will plot the points in the order
given; the latter will plot the points in ascending order of the
<code>x</code> variable, which can cause problems in the vertical
portion of the graph.</p>
<p>Let’s overlay the acceptance limits calculated by the
<code>k_equiv_two_sample</code> function as well as the values of
<code>t_1</code> and <code>t_2</code> from the sample that we discussed
in the previous section.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">curve</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">t1</span>, y <span class="op">=</span> <span class="va">t2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">k</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">k</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    t1 <span class="op">=</span> <span class="op">(</span><span class="va">qual</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="fl">116</span><span class="op">)</span> <span class="op">/</span> <span class="va">qual</span><span class="op">$</span><span class="va">sd</span>,</span>
<span>    t2 <span class="op">=</span> <span class="op">(</span><span class="va">qual</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="fl">138</span><span class="op">)</span> <span class="op">/</span> <span class="va">qual</span><span class="op">$</span><span class="va">sd</span></span>
<span>  <span class="op">)</span>,</span>
<span>  shape <span class="op">=</span> <span class="st">"*"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Acceptance criteria for alpha=0.05"</span><span class="op">)</span></span></code></pre></div>
<p><img src="equivalency-p-values_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Or better yet, we can transform this back into engineering units:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">curve</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>x_min <span class="op">=</span> <span class="va">qual</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="va">t1</span> <span class="op">*</span> <span class="va">qual</span><span class="op">$</span><span class="va">sd</span>,</span>
<span>         x_mean <span class="op">=</span> <span class="va">qual</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="va">t2</span> <span class="op">*</span> <span class="va">qual</span><span class="op">$</span><span class="va">sd</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_min</span>, y <span class="op">=</span> <span class="va">x_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">acceptance_limits</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">acceptance_limits</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    x_min <span class="op">=</span> <span class="fl">116</span>,</span>
<span>    x_mean <span class="op">=</span> <span class="fl">138</span></span>
<span>  <span class="op">)</span>,</span>
<span>  shape <span class="op">=</span> <span class="st">"*"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Acceptance criteria for alpha=0.05"</span><span class="op">)</span></span></code></pre></div>
<p><img src="equivalency-p-values_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.kloppenborg.ca" class="external-link">Stefan Kloppenborg</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
